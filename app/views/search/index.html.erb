<% title 'Search', params[:q] %>
<%= render 'shared/navbar' %>
<%= render 'products/navbar' if params[:product_id] %>

<div class="page">
  <div class="container">
    <div class="page-header">
      <form action="/<%= File.join [@product.try(:slug), 'search'].compact %>" class="pull-right form-inline">
        <input type="text" name="q" value="<%= params[:q] %>" class="form-control" autocomplete="off" size="60" />
        <input type="hidden" name="type" value="<%= @type %>">
        <button class="btn btn-default">Search</button>
      </form>

      <h2 class="page-header-title">Search</h2>
    </div>

    <% if @search %>
      <div class="row">
        <div class="col-md-9 col-xs-9">

          <div class="list-group list-group-breakout list-group-padded">
            <% @search.results.page(params[:page]).each do |result| %>
              <div class="list-group-item">
                <%= render "#{@type}_result", result: result %>
              </div>
            <% end %>
          </div>

          <%= paginate @search.results, theme: 'twitter-bootstrap-3' %>
        </div>

        <div class="col-md-3 col-xs-3">
          <%= render 'types' %>
          <%= render "#{@type.to_s}_facets", facets: @search.facets %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<%= render 'shared/footer' %>
