<div class="navbar navbar-inverse navbar-static-top">
  <div class="container-fluid">

    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#platform-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="text-brand navbar-brand" href="<%= root_path %>">
        <span class="brand">
          <span class="icon icon-logo-filled"></span>
          <% if !user_signed_in? %>
            Assembly
          <% end %>
        </span>
      </a>
    </div>

    <div class="collapse navbar-collapse" id="platform-navbar-collapse">

      <% if user_signed_in? %>
        <form action="<%= scoped_search_path %>" class="navbar-form navbar-left">
          <div class="form-group">
            <input type="text" name="q" value="<%= params[:q] %>" class="form-control" autocomplete="off"
              placeholder="<%= @product ? "Search #{@product.name}" : "Searchâ€¦" %>"  />
            <input type="hidden" name="type" value="<%= @type %>">
          </div>
          <button type="submit" class="btn btn-default sr-only">Search</button>
        </form>
      <% end %>

      <ul class="nav navbar-nav">

        <li class="<%= nav_active_class(:platform_discover) %>">
          <a href="<%= discover_path %>">Discover</a>
        </li>

        <li class="<%= nav_active_class(:platform_create) %>">
          <a href="<%= new_product_path %>">Create</a>
        </li>

        <li class="<%= nav_active_class(:platform_getting_started) %>">
          <a href="<%= getting_started_path %>">Get Started</a>
        </li>
      </ul>

      <div class="navbar-right">
        <% if user_signed_in? %>

          <ul
              class="nav navbar-nav navbar-notifications"
              data-react-class="NewsFeed"
              data-react-props="<%= {
                url: notifications_path,
              }.to_json %>">
          </ul>

          <ul
              class="nav navbar-nav navbar-notifications"
              data-react-class="Notifications"
              data-react-props="<%= {
                url: unread_path,
                type: 'chat',
                username: current_user.username
              }.to_json %>">
          </ul>

          <ul class="nav navbar-nav">

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <%= avatar_tag(current_user, 22) %>
                <span style="margin-left: 5px;"><%= current_user.username %></span>
                <b class="caret"></b>
              </a>

              <ul class="dropdown-menu">
                <li>
                  <a href="<%= user_path(current_user) %>">
                    <i class="icon-user dropdown-glyph"></i>
                    Profile
                  </a>
                </li>
                <li>
                  <a href="<%= edit_user_path(current_user) %>">
                    <i class="icon-settings dropdown-glyph"></i>
                    Settings
                  </a>
                </li>
                <li class="divider"></li>
                <li>
                  <a href="<%= destroy_user_session_path %>" data-method="delete">
                    <i class="icon-logout dropdown-glyph"></i>
                    Log out
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        <% else %>
          <ul class="nav navbar-nav">
            <li>
              <a href="<%= new_user_session_path %>">
                Log in
              </a>
            </li>
          </ul>

          <a class="btn btn-success navbar-btn" href="<%= new_user_registration_path %>">Sign up</a>
        <% end %>

        </ul>
      </div>
    </div>
  </div>
</div>
