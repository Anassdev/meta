<% title @user.username %>
<%= track_engaged 'user' %>
<%= render 'shared/navbar' %>

<div class="page page-flat">
  <div class="container">

    <div class="row">
      <div class="col-sm-3 col-xs-12">

        <%= render 'users/card', user: @user %>

        <% if can?(:update, @user) %>
          <a class="btn btn-default btn-block" href="<%= edit_user_path %>">
            Edit Profile
          </a>
          <br>
        <% end %>

        <% if Rails.env.development? || staff? %>
          <div class="well well-sm small">
            <div><%= @user.email %></div>
            <div>last request
              <%= time_ago_in_words(@user.last_request_at) %> ago</div>
            <div><%=link_to('Impersonate user', "/discover?auth_token=#{@user.authentication_token}")%></div>
            <div>
              <% if @user.flagged_at %>
                <a href="<%= unflag_user_path(@user) %>" data-method="patch">Unflag</a>
              <% else %>
                <a href="<%= flag_user_path(@user) %>" data-method="patch">Flag</a>
              <% end %>
            </div>
            <div>
              <% if @user.deleted_at %>
                Account removed <%= time_ago_in_words(@user.deleted_at) %> ago
              <% else %>
                <%= react_component 'ConfirmActionButton',
                              requireText: @user.username,
                              buttonLabel: 'Delete user account',
                              promptText: "This will delete everything! Type the user's username to confirm",
                              action: delete_account_user_path(@user) %>
              <% end %>
            </div>
          </div>
        <% end %>

      </div>

      <div class="col-sm-9 col-xs-12">
        <div class="page-header sheet-header">
          <%= render 'users/overview' %>
        </div>

        <% if @products.present? %>
          <h2>Core team member of these products</h2>
          <div class="list-group list-group-breakout">
            <% @products.each do |product| %>
              <a class="list-group-item" href="<%= product_path(product) %>">
                <%= render 'products/chips/greenlit', product: product %>
              </a>
            <% end %>
          </div>
        <% end %>

        <h2>Bounties</h2>
        <%= render 'bounties/filtered' %>
      </div>
    </div>
  </div>
</div>

<%= render 'shared/footer' %>
