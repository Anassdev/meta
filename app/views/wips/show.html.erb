<% title @wip.title, "##{@wip.number}", @wip.product.name %>
<% activate_nav! :bounties %>
<% breadcrumb product_wips_path(@wip.product), 'Bounties' %>

<%= render 'header' %>
<div class="row">
  <div class="col-md-9 col-xs-9">
    <div id="discussion-view-el">
      <div data-react-class="Discussion" data-react-props="<%= {
        canAward: can?(:award, @wip),
        activities: ActiveModel::ArraySerializer.new(@activities, scope: current_user, each_serializer: ActivitySerializer).as_json
      }.to_json %>"></div>

      <div class="well js-upvote-reminder" style="display:none">
        You've commented on this Bounty but you haven't upvoted. Your upvotes reward people with more coins for completing Bounties which helps make <%= @product.name %> a better product.
      </div>

      <%= render 'new_event_form' %>
    </div>
  </div>


  <div class="col-md-3 col-xs-3">
    <%= render partial: 'tasks/task_sidebar' %>
  </div>
</div>

<% if signed_in? %>
  <img class="hidden" src="<%= ReadraptorTracker.new(ReadRaptorSerializer.serialize_entities(@wip).first, current_user.id).url %>" />
<% end %>

<script>
  app.product = new Product(<%= json @product, scope: current_user %>);
  app.wip = new Wip(<%== WipSerializer.new(@wip, scope: current_user).to_json %>);
  analytics.track('product.wip.viewed', <%== WipAnalyticsSerializer.new(@wip, scope: current_user).to_json %>)
  new DiscussionInputView({
    el: $('.js-new-event'),
    model: app.wip
  });
</script>
